<!DOCTYPE html>
<html lang="he" dir="rtl">

<head>
    <meta charset="UTF-8" dir="rtl">
    <title>מעריך הצעת מחיר</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Hebrew:wght@400;700&display=swap" rel="stylesheet">


    

    <style>
        h1, p ,span{
    white-space: pre-wrap; /* Preserve spaces and line breaks */
}
        body {
             font-family: 'Noto Sans Hebrew', Arial, sans-serif;
            font-size: 16px;
            direction: rtl;
            text-align: right;
            margin: 0;
            padding: 0;
            background-color: #ffffff;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background-color: rgba(0, 0, 0, 0.01);
            color: black;
        }

        .business-details {
            text-align: right;
        }

        .logo img {
            width: 190px;
        }

        .customer {
            border-top: 1px dashed black;
            padding: 10px;
            background-color: #ffffff;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .customer h2 {
            margin-bottom: 20px;
        }

        .customer input {
            margin: 5px 0;
            padding: 5px;
            width: 170px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background-color: #ffffff;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        th,
        td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: right;
        }

        th {
            background-color: rgba(0, 0, 0, 0.01);
            color: black;
        }

        tfoot td {
            font-weight: bold;
            background-color: #f1f1f1;
        }

        button {
            padding: 10px 20px;
            margin: 10px;
            background-color: #4a3ddf;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        button:hover {
            background-color: #4300eb;
        }

        #content {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        #total-price {
            font-weight: bold;
            color: #000000;
        }
        #content {
    width: 100%; /* Make it span the entire page */
    max-width: none;
    margin: 0;
    padding: 20px;
    box-sizing: border-box;
    display: flex;
     justify-content: center;
      align-items: center;
      direction: rtl;
}
@media print {
    body {
        margin: 0;
        direction: rtl;
        text-align: right;
        font-family: 'Noto Sans Hebrew', Arial, sans-serif;
    }
    table {
        width: 100%;
        direction: rtl;
        text-align: right;
        border-collapse: collapse;
    }
    th, td {
        padding: 10px;
        border: 1px solid #ddd;
        text-align: right;
    }
    #content {
        max-width: 800px;
        margin: auto;
    }
}
    </style>
</head>

<body>
    <div id="content" >
        <div dir="rtl" style="width: 90vw;text-align: center;">
        <header>
            <div class="business-details" style="direction: rtl; text-align: right;">
                <h2> מרפאת<span> </span>
                    שיניים<span> </span>
                     עומר<span> </span>
                עומרי</h2>
                <p>כתובת-  החשמל 8, עפולה </p>
                <p>טלפון- 052-8799309 </p>
                <p>תאריך: <span id="date"></span></p>
            </div>
            <div class="title">
                <h1>הצעת<span> מחיר </span> </h1>
                </div>
            <div class="logo">
                <img src="./omar.png" alt="Logo">
            </div>
        </header>

        <div class="customer">
            <h2>:פרטי לקוח</h2>
            <label for="name">שם:</label>
            <input id="name" type="text" placeholder="הכנס שם לקוח">

            <label for="add">כתובת:</label>
            <input id="add" type="text" placeholder="הכנס כתובת">

            <label for="tel">טלפון:</label>
            <input id="tel" type="tel" placeholder="הכנס מספר טלפון">
        </div>

        <main>
            <table>
                <thead>
                    <tr>
                        <th>מוצר</th>
                        <th>מחיר (ש"ח)</th>
                        <th>פעולות</th>
                    </tr>
                </thead>
                <tbody id="product-table">
                    <tr>
                        <td><input type="text" placeholder="מוצר"></td>
                        <td><input type="number" placeholder="מחיר"></td>
                        <td><button class="delete-row de">מחק</button></td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr>
                        <td colspan="2">סכום כולל:</td>
                        <td id="total-price">0</td>
                    </tr>
                </tfoot>
            </table>

            <button id="add-row" class="de">הוסף מוצר</button>
            <button id="calc" class="de">חשב</button>
            <button id="export-pdf"class="de">ייצוא ל-PDF</button>
        </main>
    </div>
    </div>

    <script>
        // Set today's date
        const today = new Date();
        const options = { day: '2-digit', month: '2-digit', year: 'numeric' };
        const formattedDate = today.toLocaleDateString('he-IL', options);
        document.getElementById('date').textContent = formattedDate;

        // Add new product row
        document.getElementById('add-row').addEventListener('click', () => {
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td><input type="text" placeholder="מוצר"></td>
                <td><input type="number" placeholder="מחיר"></td>
                <td><button class="delete-row">מחק</button></td>
            `;
            document.getElementById('product-table').appendChild(newRow);
            calculateTotal();
        });

        // Delete product row
        document.getElementById('product-table').addEventListener('click', (event) => {
            if (event.target.classList.contains('delete-row')) {
                event.target.closest('tr').remove();
                calculateTotal();
            }
        });

        // Calculate total price
        function calculateTotal() {
            const rows = document.querySelectorAll('#product-table tr');
            let total = 0;
            rows.forEach((row) => {
                const priceInput = row.querySelector('input[type="number"]');
                total += parseFloat(priceInput?.value) || 0;
            });
            document.getElementById('total-price').textContent = total.toFixed(2);
        }

        document.getElementById('calc').addEventListener('click', calculateTotal);

        // Export to PDF
        document.getElementById('export-pdf').addEventListener('click', () => {
            const buttons = document.querySelectorAll('button');
            buttons.forEach(button => button.style.display = 'none');
            const element = document.getElementById('content');
             
            const options = {
                margin: 0, // Remove margins for a perfect fit
                filename: `${document.getElementById('name').value}-quotation.pdf`,
                image: { type: 'jpeg', quality: 1.0 },
                html2canvas: {
                    scale: 6, // Increase the scale for high resolution
                    useCORS: true, // Fix cross-origin image issues
                },
                jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait' },
            };


             html2pdf().set(options).from(element).save().then(() => {
                buttons.forEach(button => button.style.display = ''); // Show buttons again
            });
        });
    </script>
</body>

</html>